<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>All Downloader by Ryzendesu</title>
  <style>
    body { font-family: sans-serif; background: #f5f5f5; padding: 20px; text-align: center; }
    input, button { padding: 10px; margin: 10px; width: 80%; max-width: 400px; }
    .result { margin-top: 20px; }
    video, img { max-width: 90%; margin: 10px 0; }
  </style>
</head>
<body>
  <h1>All Downloader</h1>
  <input type="text" id="urlInput" placeholder="Masukin link dari TikTok, YouTube, IG, dll..." />
  <button onclick="downloadMedia()">Download</button>

  <div class="result" id="result"></div>

  <script>
    async function downloadMedia() {
      const url = document.getElementById('urlInput').value.trim();
      const resultBox = document.getElementById('result');
      resultBox.innerHTML = 'Loading...';

      if (!url) {
        resultBox.innerHTML = 'Masukin link dulu bro!';
        return;
      }

      let endpoint = '';
      if (url.includes('tiktok.com')) endpoint = 'tiktok';
      else if (url.includes('youtube.com') || url.includes('youtu.be')) endpoint = 'youtube';
      else if (url.includes('instagram.com')) endpoint = 'igdl';
      else if (url.includes('twitter.com') || url.includes('x.com')) endpoint = 'twitter';
      else {
        resultBox.innerHTML = 'Link belum didukung atau salah format.';
        return;
      }

      try {
        const res = await fetch(`https://api.ryzendesu.vip/api/${endpoint}?url=${encodeURIComponent(url)}`);
        const data = await res.json();

        if (data.status === false || data.code === 403) {
          resultBox.innerHTML = 'Gagal download. Coba link lain atau endpoint-nya error.';
          return;
        }

        // tampilkan hasil
        if (endpoint === 'youtube') {
          resultBox.innerHTML = `<a href="${data.result.audio}" download>Download Audio</a><br/>
                                 <a href="${data.result.video}" download>Download Video</a>`;
        } else if (endpoint === 'tiktok') {
          resultBox.innerHTML = `<video controls src="${data.result.video}" autoplay loop></video><br/>
                                 <a href="${data.result.video}" download>Download Video</a>`;
        } else if (endpoint === 'igdl') {
          resultBox.innerHTML = data.result.map(media => `
            ${media.type === 'video' ? 
              `<video controls src="${media.url}" autoplay loop></video>` :
              `<img src="${media.url}" />`}
            <br/><a href="${media.url}" download>Download</a>
          `).join('');
        } else if (endpoint === 'twitter') {
          resultBox.innerHTML = data.result.map(media => `
            <video controls src="${media.url}" autoplay loop></video>
            <br/><a href="${media.url}" download>Download</a>
          `).join('');
        } else {
          resultBox.innerHTML = 'Berhasil, tapi nggak bisa ditampilkan di sini.';
        }

      } catch (err) {
        resultBox.innerHTML = 'Error saat fetching data: ' + err.message;
      }
    }
  </script>
</body>
</html>
